---
title: "KPMB Data Analytics Virtual Experience"
output: html_notebook
---


Checking parts of data that need cleaning.


```{r}
# Import
library("readxl")
library("dplyr")
library("ggplot2")
library("lubridate")

# Set path
path <- "KPMG_VI_New_raw_data_update_final.xlsx"

# Get sheets name
excel_sheets(path = path)

```
Define common procedures
```{r}
stats_cat <- function(col){
    num_row <- nrow(col)
    num_na <- sum(is.na(col))
    num_dup <- sum(duplicated(col))
    num_unique <- nrow(unique(col))
    
    Variable <- c("Number of Rows", "Number of NAs", "Number of Duplicates", "Number of Uniques")
    Value <- c(num_row, num_na, num_dup, num_unique)
    res <- data.frame(Variable, Value)
    return(res)
}

stats_num <- function(col){
    num_row <- nrow(col)
    min <- min(col, na.rm = TRUE)
    max <- max(col, na.rm=TRUE)
    num_na <- sum(is.na(col))
    num_dup <- sum(duplicated(col))
    num_unique <- nrow(unique(col))
    
    Variable <- c("Number of Rows", "Min", "Max", "Number of NAs", "Number of Duplicates", "Number of Uniques")
    Value <- c(num_row, min, max, num_na, num_dup, num_unique)
    res <- data.frame(Variable, Value)
    return(res)
}

stats_date <- function(col){
    num_row <- nrow(col)
    num_na <- sum(is.na(col))
    num_dup <- sum(duplicated(col))
    num_unique <- nrow(unique(col))
    
    Variable <- c("Number of Rows", "Number of NAs", "Number of Duplicates", "Number of Uniques")
    Value <- c(num_row, num_na, num_dup, num_unique)
    res <- data.frame(Variable, Value)
    return(res)
}

```

TRANSACTIONS sheet

```{r}
df_trans <- read_excel(path, sheet = "Transactions", skip = 1)
head(df_trans)

```

```{r}
# Change columns data types
to_chr <- c("transaction_id", "product_id", "customer_id")
df_trans[to_chr] <- sapply(df_trans[to_chr], as.character)

```
TRANSACTIONS sheet: transaction_id

```{r}
stats_cat(df_trans["transaction_id"])
```
TRANSACTIONS sheet: product_id
```{r}
stats_cat(df_trans["product_id"])
```
```{r}
# Unique values
uniques <- unique(df_trans["product_id"])
pull(uniques, product_id)
```
TRANSACTIONS sheet: customer_id
```{r}
stats_cat(df_trans["customer_id"])
```
TRANSACTIONS sheet: transaction_date
```{r}
stats_date(df_trans["transaction_date"])

```
```{r}
min <- min(df_trans$transaction_date, na.rm = TRUE)
max <- max(df_trans$transaction_date, na.rm = TRUE)
data.frame(min, max)

```
```{r}
ggplot(df_trans, aes(x=transaction_date)) + geom_histogram()
```

TRANSACTIONS sheet: online_order
```{r}
stats_cat(df_trans["online_order"])
```
```{r}
unique(df_trans["online_order"])
```
```{r}
ggplot(df_trans["online_order"], aes(x=online_order)) + geom_bar()
```
TRANSACTIONS sheet: order_status
```{r}
stats_cat(df_trans["order_status"])
```

```{r}
ggplot(df_trans["order_status"], aes(x=order_status)) + geom_bar()
```
TRANSACTIONS sheet: brand
```{r}
stats_cat(df_trans["brand"])
```
```{r}
unique(df_trans["brand"])
```
```{r}
ggplot(df_trans["brand"], aes(x=brand)) + geom_bar()
```
TRANSACTIONS sheet: product_line
```{r}
stats_cat(df_trans["product_line"])
```
```{r}
unique(df_trans["product_line"])
```
```{r}
ggplot(df_trans["product_line"], aes(x=product_line)) + geom_bar()
```
TRANSACTIONS sheet: product_size

```{r}
stats_cat(df_trans["product_size"])
```
```{r}
unique(df_trans["product_size"])
```
```{r}

ggplot(df_trans["product_size"], aes(x=product_size)) + geom_bar()
```
TRANSACTIONS sheet: list_price
```{r}
stats_num(df_trans["list_price"])
```
```{r}
ggplot(df_trans, aes(x=list_price)) + geom_histogram()

```

```{r}
# Check to see if there is a character value in this numeric column
vec <- pull(df_trans, list_price )
sum(is.na(as.numeric(as.character(vec))))
```
TRANSACTIONS sheet: standard_cost

```{r}
stats_num(df_trans["standard_cost"])
```
```{r}
ggplot(df_trans, aes(x=standard_cost)) + geom_histogram()

```
```{r}
# Check to see if there is a character value in this numeric column
vec <- pull(df_trans, standard_cost )
sum(is.na(as.numeric(as.character(vec))))
```
TRANSACTIONS sheet: product_first_sold_date

```{r}
stats_num(df_trans["product_first_sold_date"])
```
```{r}
# Check to see if there is a character value in this numeric column
vec <- pull(df_trans, standard_cost )
sum(is.na(as.numeric(as.character(vec))))
```






